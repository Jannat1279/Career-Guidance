<!DOCTYPE html>
<html>
<head>
    <title>AI Chatbot</title>

    <style>
        body {
            font-family: Arial, sans-serif;
            background: #eef2ff;
        }

        .chat-container {
            width: 520px;
            margin: 40px auto;
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        h2 {
            text-align: center;
        }

        .chat-box {
            height: 420px;
            overflow-y: auto;
            padding: 10px;
            border-bottom: 2px solid #eee;
        }

        .user-msg, .bot-msg {
            padding: 12px 15px;
            margin: 10px 0;
            border-radius: 12px;
            max-width: 80%;
            line-height: 1.5;
        }

        .user-msg {
            background: #007bff;
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 0;
        }

        .bot-msg {
            background: #f0f2ff;
            color: #333;
            margin-right: auto;
            border-bottom-left-radius: 0;
        }

        input {
            width: 78%;
            padding: 12px;
            border-radius: 10px;
            border: 1px solid #aaa;
            font-size: 16px;
        }

        button {
            width: 20%;
            padding: 12px;
            margin-left: 5px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
        }

        button:hover {
            background: #0056cc;
        }

        .bot-msg h1, .bot-msg h2, .bot-msg h3 {
            margin: 10px 0 5px;
        }
    </style>
</head>

<body>

<div class="chat-container">
    <h2>ðŸ’¬ AI Career Chatbot</h2>

    <div class="chat-box" id="chatBox"></div>

    <div style="display:flex; margin-top: 10px;">
        <input id="userInput" placeholder="Ask your question..." />
        <button onclick="sendMessage()">Send</button>
    </div>
</div>

<script>
function sendMessage() {
    let msg = document.getElementById("userInput").value;
    if (!msg) return;

    addMessage(msg, "user");
    document.getElementById("userInput").value = "";

    fetch("/ask", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({ message: msg })
    })
    .then(res => res.json())
    .then(data => addMessage(data.reply, "bot"));
}

function addMessage(text, sender) {
    let chatBox = document.getElementById("chatBox");
    let msgDiv = document.createElement("div");

    msgDiv.className = sender === "user" ? "user-msg" : "bot-msg";
    msgDiv.innerHTML = formatText(text);

    chatBox.appendChild(msgDiv);
    chatBox.scrollTop = chatBox.scrollHeight;
}

// Converts Markdown-like text to readable HTML
function formatText(text) {
    text = text.replace(/\n/g, "<br>");
    text = text.replace(/\*\*(.*?)\*\*/g, "<b>$1</b>");
    text = text.replace(/### (.*?)(<br>|$)/g, "<h3>$1</h3>");
    text = text.replace(/## (.*?)(<br>|$)/g, "<h2>$1</h2>");
    text = text.replace(/# (.*?)(<br>|$)/g, "<h1>$1</h1>");
    text = text.replace(/^- /gm, "â€¢ ");
    text = text.replace(/^\* /gm, "â€¢ ");
    return text;
}
</script>

</body>
</html>
